
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Supplementary Material &#8212; PyNLO dev documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PyNLO Reference" href="../api.html" />
    <link rel="prev" title="Nonlinear Optics" href="nonlinear_optics.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/pynlo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../about.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../notes.html">
  Notes
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p class="caption">
 <span class="caption-text">
  Topics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fourier_transforms.html">
   Fourier Transforms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_optics.html">
   Linear Optics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nonlinear_optics.html">
   Nonlinear Optics
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Supplementary Material
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Transverse-and-Longitudinal-Vector-Components">
   Transverse and Longitudinal Vector Components
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Curl">
     Curl
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Gradient">
     Gradient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Matrix-Multiplication">
     Matrix Multiplication
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Transverse-and-Longitudinal-Maxwell’s-Equations">
   Transverse and Longitudinal Maxwell’s Equations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Maxwell’s-equations">
     Maxwell’s equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Wave-Equations">
     Wave Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Divergence-Equations">
     Divergence Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Transverse-Curl-Equations">
     Transverse Curl Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Longitudinal-Curl-Equations">
     Longitudinal Curl Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Transverse-Wave-Equations">
     Transverse Wave Equations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Derivation-of-the-Forward-and-Backward-Propagation-Equations">
   Derivation of the Forward and Backward Propagation Equations
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Modal-Expansion-of-4c">
     Modal Expansion of 4c
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Modal-Expansion-of-4d">
     Modal Expansion of 4d
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Forward-Mode-Propagation-Equation">
     Forward Mode Propagation Equation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Backward-Mode-Propagation-Equation">
     Backward Mode Propagation Equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Unit-Analysis-of-the-Effective-Nonlinear-Parameters">
   Unit Analysis of the Effective Nonlinear Parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Relationship-Between-Kerr-Parameter-and-Nonlinear-Susceptibility">
   Relationship Between Kerr Parameter and Nonlinear Susceptibility
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="Supplementary-Material">
<h1>Supplementary Material<a class="headerlink" href="#Supplementary-Material" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Transverse-and-Longitudinal-Vector-Components">
<h2>Transverse and Longitudinal Vector Components<a class="headerlink" href="#Transverse-and-Longitudinal-Vector-Components" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{z}} \times \left(\mathbf{A} \times \hat{\mathbf{z}}\right) &amp;= \mathbf{A}_t
\\
\hat{\mathbf{z}} \cdot \mathbf{A} &amp;= A_z
\end{align}\end{split}\]</div>
<div class="section" id="Curl">
<h3>Curl<a class="headerlink" href="#Curl" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{z}} \times \left(\left(\nabla \times \mathbf{A}\right) \times \hat{\mathbf{z}}\right) &amp;= \hat{\mathbf{z}} \times \left(\frac{\partial}{\partial z} \mathbf{A}_t - \nabla_t A_z\right)
\\
\hat{\mathbf{z}} \cdot \left(\nabla \times \mathbf{A}\right) &amp;= \hat{\mathbf{z}} \cdot \left(\nabla_t \times \mathbf{A}_t\right)
\\
\hat{\mathbf{z}} \times \left(\left(\nabla \times \left(\nabla \times \mathbf{A}\right)\right) \times \hat{\mathbf{z}} \right) &amp;= -\nabla^2 \mathbf{A}_t + \nabla_t\left( \nabla \cdot \mathbf{A} \right)
\\
\hat{\mathbf{z}} \cdot \left(\nabla \times \left(\nabla \times \mathbf{A}\right)\right) &amp;= \hat{\mathbf{z}} \cdot \left(\frac{\partial}{\partial z} \left(\nabla_t \cdot \mathbf{A}_t\right) \hat{\mathbf{z}} -\nabla_t^2 A_z \ \hat{\mathbf{z}}\right)
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Gradient">
<h3>Gradient<a class="headerlink" href="#Gradient" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{z}} \times \left(\nabla a \times \hat{\mathbf{z}}\right) &amp;= \nabla_t a
\\
\hat{\mathbf{z}} \cdot \nabla a &amp;= \hat{\mathbf{z}} \cdot \left(\frac{\partial}{\partial z} a \, \hat{\mathbf{z}}\right)
\\
\hat{\mathbf{z}} \times \left(\nabla \left(\nabla \cdot \mathbf{A}\right) \times \hat{\mathbf{z}}\right) &amp;= \nabla_t \left(\nabla \cdot \mathbf{A}\right)
\\
\hat{\mathbf{z}} \cdot \nabla \left(\nabla \cdot \mathbf{A}\right) &amp;= \hat{\mathbf{z}} \cdot \left(\frac{\partial}{\partial z} \left(\nabla \cdot \mathbf{A}\right) \hat{\mathbf{z}}\right)
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Matrix-Multiplication">
<h3>Matrix Multiplication<a class="headerlink" href="#Matrix-Multiplication" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\epsilon &amp;= \left(
    \begin{array}{ccc}
    \epsilon_{xx} &amp; \epsilon_{xy} &amp; 0 \\
    \epsilon_{yx} &amp; \epsilon_{yy} &amp; 0 \\
    0 &amp; 0 &amp; \epsilon_{zz} \\
    \end{array}\right)
\\
\epsilon_t &amp;= \left(
    \begin{array}{ccc}
    \epsilon_{xx} &amp; \epsilon_{xy} &amp; 0 \\
    \epsilon_{yx} &amp; \epsilon_{yy} &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    \end{array}\right)
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{z}} \times \left(\left(\epsilon \cdot \mathbf{A}\right) \times \hat{\mathbf{z}}\right) &amp;= \epsilon_t \cdot \mathbf{A}_t
\\
\hat{\mathbf{z}} \cdot \left(\epsilon \cdot \mathbf{A}\right) &amp;= \hat{\mathbf{z}} \cdot \left(\epsilon_{zz} \, A_z \, \hat{\mathbf{z}} \right)
\end{align}\end{split}\]</div>
<p>Assuming <span class="math notranslate nohighlight">\(\frac{\partial}{\partial z} \epsilon = 0\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{z}} \times \left(\epsilon \cdot \left(\mathbf{A}_t \times \hat{\mathbf{z}}\right)\right) &amp;= \mathbf{\tilde{\epsilon}}_t \cdot \mathbf{A}_t
\\
\mathbf{\tilde{\epsilon}} &amp;= \left(
    \begin{array}{ccc}
    \epsilon_{yy} &amp; -\epsilon_{yx} &amp; 0 \\
    -\epsilon_{xy} &amp; \epsilon_{xx} &amp; 0 \\
    0 &amp; 0 &amp; \epsilon_{zz} \\
    \end{array}\right)
\\
\mathbf{\tilde{\epsilon}}_t &amp;= \left(
    \begin{array}{ccc}
    \epsilon_{yy} &amp; -\epsilon_{yx} &amp; 0 \\
    -\epsilon_{xy} &amp; \epsilon_{xx} &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    \end{array}\right) = \left(
    \begin{array}{ccc}
    0 &amp; -1 &amp; 0 \\
    1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    \end{array}\right) \cdot \epsilon \cdot \left(
    \begin{array}{ccc}
    0 &amp; 1 &amp; 0 \\
    -1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    \end{array}\right)
\\
\mathbf{\tilde{\epsilon}}^{-1}_t &amp;= \left(
    \begin{array}{ccc}
    0 &amp; -1 &amp; 0 \\
    1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    \end{array}\right) \cdot \epsilon^{-1} \cdot \left(
    \begin{array}{ccc}
    0 &amp; 1 &amp; 0 \\
    -1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 \\
    \end{array}\right)
\\
\epsilon \cdot \epsilon^{-1} &amp;= \mathbf{1}
\\
\mathbf{\tilde{\epsilon}} \cdot \mathbf{\tilde{\epsilon}}^{-1} &amp;= \mathbf{1}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{z}} \times \left(\left(\nabla \times \left(\epsilon^{-1} \cdot \left(\nabla \times \mathbf{A}\right)\right)\right) \times \hat{\mathbf{z}} \right) &amp;= \mathbf{\tilde{\epsilon}}^{-1}_t \cdot \left( -\frac{\partial^2}{\partial z^2} \mathbf{A}_t + \frac{\partial}{\partial z} \nabla_t A_z \right)
\\
    &amp; \qquad + \epsilon^{-1}_{zz} \left( -\nabla^2_t \mathbf{A}_t + \nabla_t \left( \nabla_t \cdot \mathbf{A}_t \right)\right)
\\
    &amp; \qquad + \left(\nabla_t \epsilon^{-1}_{zz}\right) \times \left( \nabla_t \times \mathbf{A}_t \right)
\\
\hat{\mathbf{z}} \cdot \left(\nabla \times \left(\epsilon^{-1} \cdot \left(\nabla \times \mathbf{A}\right)\right)\right) &amp;= {\mathbf{\tilde{\epsilon}}^{-1}_t}_{ij} \left( \frac{\partial}{\partial z} {\nabla_t}_i {\mathbf{A}_t}_j - {\nabla_t}_i {\nabla_t}_j A_z \right)
\\
&amp; \qquad + \left({\nabla_t}_i {\mathbf{\tilde{\epsilon}}^{-1}_t}_{ij}\right) \left( \frac{\partial}{\partial z} {\mathbf{A}_t}_j - {\nabla_t}_j A_z \right)
\end{align}\end{split}\]</div>
</div>
</div>
<div class="section" id="Transverse-and-Longitudinal-Maxwell’s-Equations">
<h2>Transverse and Longitudinal Maxwell’s Equations<a class="headerlink" href="#Transverse-and-Longitudinal-Maxwell’s-Equations" title="Permalink to this headline">¶</a></h2>
<p>Maxwell’s equations are separable into transverse and longitudinal components assuming a source free medium, longitudinal invariance <span class="math notranslate nohighlight">\(\left(\frac{\partial}{\partial z} \epsilon = 0\right)\)</span>, and <span class="math notranslate nohighlight">\(\epsilon\)</span> generally in the previous section. In the mixed Fourier domain <span class="math notranslate nohighlight">\(\left(\omega, \mathbf{x}\right)\)</span>, with <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{D} &amp;= \epsilon_0 \left(\epsilon \cdot \mathbf{E}\right)
\\
\mathbf{B} &amp;= \mu_0 \mathbf{H}
\end{align}\end{split}\]</div>
<div class="section" id="Maxwell’s-equations">
<h3>Maxwell’s equations<a class="headerlink" href="#Maxwell’s-equations" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
0 &amp;= \nabla \cdot \left(\epsilon \cdot \mathbf{E}\right)
\\
0 &amp;= \nabla \cdot \mathbf{H}
\\
\mathbf{0} &amp;= \nabla \times \mathbf{E} + i \, \omega \, \mu_0 \, \mathbf{H}
\\
\mathbf{0} &amp;= \nabla \times \mathbf{H} - i \, \omega \, \epsilon_0 \left(\epsilon \cdot \mathbf{E}\right)
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Wave-Equations">
<h3>Wave Equations<a class="headerlink" href="#Wave-Equations" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= \nabla \times \left(\nabla \times \mathbf{E} \right) - \frac{\omega^2}{c^2} \left(\epsilon \cdot \mathbf{E} \right)
\\
\mathbf{0} &amp;= \nabla \times \left(\epsilon^{-1} \cdot \left(\nabla \times \mathbf{H}\right)\right) - \frac{\omega^2}{c^2} \mathbf{H}
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Divergence-Equations">
<h3>Divergence Equations<a class="headerlink" href="#Divergence-Equations" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
0 &amp;= \nabla_t \cdot \left(\epsilon_t \cdot \mathbf{E}_t\right) + \epsilon_{zz} \, \frac{\partial}{\partial z} E_z
\\
0 &amp;= \nabla_t \cdot \mathbf{H}_t + \frac{\partial}{\partial z} H_z
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Transverse-Curl-Equations">
<h3>Transverse Curl Equations<a class="headerlink" href="#Transverse-Curl-Equations" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= \hat{\mathbf{z}} \times \left(\frac{\partial}{\partial z} \mathbf{E}_t - \nabla_t E_z\right) + i \, \omega \, \mu_0 \, \mathbf{H}_t
\\
\mathbf{0} &amp;= \hat{\mathbf{z}} \times \left(\frac{\partial}{\partial z} \mathbf{H}_t - \nabla_t H_z\right) - i \, \omega \, \epsilon_0 \left( \epsilon_t \cdot \mathbf{E}_t \right)
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Longitudinal-Curl-Equations">
<h3>Longitudinal Curl Equations<a class="headerlink" href="#Longitudinal-Curl-Equations" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= \nabla_t \times \mathbf{E}_t + i \, \omega \, \mu_0 \, H_z \hat{\mathbf{z}}
\\
\mathbf{0} &amp;= \nabla_t \times \mathbf{H}_t - i \, \omega \, \epsilon_0 \, \epsilon_{zz} \, E_z \, \hat{\mathbf{z}}
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Transverse-Wave-Equations">
<h3>Transverse Wave Equations<a class="headerlink" href="#Transverse-Wave-Equations" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= -\frac{\partial^2}{\partial z^2} \mathbf{E}_t - \nabla^2_t \mathbf{E}_t + \nabla_t \left(\nabla \cdot \mathbf{E}\right) - \frac{\omega^2}{c^2} \left(\epsilon_t \cdot \mathbf{E}_t\right)
\\
&amp;= -\frac{\partial^2}{\partial z^2} \mathbf{E}_t - \nabla^2_t \mathbf{E}_t + \nabla_t \left(\nabla_t \cdot \left(\left(\mathbf{1} - \epsilon_{zz}^{-1} \, \epsilon_t \right) \cdot \mathbf{E}_t \right)\right)
\\
&amp; \qquad + \nabla_t \left(\left( \nabla_t \epsilon_{zz}^{-1} \right) \cdot \left(\epsilon_t \cdot \mathbf{E}_t\right)\right) - \frac{\omega^2}{c^2} \left(\epsilon_t \cdot \mathbf{E}_t\right)
\\ \\
\mathbf{0} &amp;= \mathbf{\tilde{\epsilon}}^{-1}_t \cdot \left(-\frac{\partial^2}{\partial z^2} \mathbf{H}_t + \frac{\partial}{\partial z} \nabla_t H_z\right) + \epsilon_{zz}^{-1} \left(-\nabla^2_t \mathbf{H}_t + \nabla_t \left(\nabla_t \cdot \mathbf{H}_t\right)\right)
\\
&amp; \qquad + \left(\nabla_t \epsilon_{zz}^{-1}\right) \times \left(\nabla_t \times \mathbf{H}_t\right) - \frac{\omega^2}{c^2} \mathbf{H}_t
\\
&amp;= -\frac{\partial^2}{\partial z^2} \mathbf{H}_t - \epsilon_{zz}^{-1} \, \mathbf{\tilde{\epsilon}}_t \cdot \left(\nabla_t^2 \mathbf{H}_t\right) - \left(\mathbf{1} - \epsilon_{zz}^{-1} \, \mathbf{\tilde{\epsilon}}_t\right) \cdot \nabla_t \left(\nabla_t \cdot \mathbf{H}_t\right)
\\
&amp; \qquad + \mathbf{\tilde{\epsilon}}_t \cdot \left(\left(\nabla_t \epsilon_{zz}^{-1}\right) \times \left(\nabla_t \times \mathbf{H}_t\right)\right) - \frac{\omega^2}{c^2} \left(\mathbf{\tilde{\epsilon}}_t \cdot \mathbf{H}_t\right)
\end{align}\end{split}\]</div>
<p>where the second step is obtained by applying the divergence equations.</p>
</div>
</div>
<div class="section" id="Derivation-of-the-Forward-and-Backward-Propagation-Equations">
<h2>Derivation of the Forward and Backward Propagation Equations<a class="headerlink" href="#Derivation-of-the-Forward-and-Backward-Propagation-Equations" title="Permalink to this headline">¶</a></h2>
<p>The propagation equations are derived by substituting the modal expansion into the curl equations, with the only additional assumption being that <span class="math notranslate nohighlight">\(\epsilon\)</span> is separable into transverse and longitudinal components.</p>
<p>As seen in the following results, the evolution of the amplitude is driven by the following effects:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
\frac{\partial}{\partial z} a_n = \begin{cases}
\text{linear dispersion} \\
\text{gain or loss} \\
\text{changing mode profiles} \\
\text{free sources and nonlinearity}
\end{cases}
\end{gather}\end{split}\]</div>
<div class="section" id="Modal-Expansion-of-4c">
<h3>Modal Expansion of 4c<a class="headerlink" href="#Modal-Expansion-of-4c" title="Permalink to this headline">¶</a></h3>
<p>Inserting the expansion of eq-1 into eq-4c of Maxwell’s equations from <a class="reference internal" href="nonlinear_optics.html#Unidirectional-Propagation-Equations"><span class="std std-ref">Nonlinear Optics</span></a> section yields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= \sum_m \left(
    \nabla \times \left(a_m \, \hat{\mathbf{e}}_m\right)
    + i \, \omega \, \mu_0 \, \left(a_m \, \hat{\mathbf{h}}_m\right)
    + \left(\text{b.p.m.}\right)\right) \tag{s1}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\nabla \times \hat{\mathbf{e}}_m\right)
    + \left(\nabla a_m\right) \times \hat{\mathbf{e}}_m
  \\
  &amp; \qquad + a_m \left(i \, \omega \, \mu_0 \, \hat{\mathbf{h}}_m\right)
    + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s2}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(
        \hat{\mathbf{z}} \times \left(
            \frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t
            - \nabla_t {\hat{e}_m}_z
        \right)
        + \nabla_t \times {\hat{\mathbf{e}}_m}_t
    \right)
    \\
    &amp; \qquad + \left(\frac{\partial}{\partial z} a_m\right) \, \hat{\mathbf{z}} \times \hat{\mathbf{e}}_m
    + a_m \left(i \, \omega \, \mu_0 \, \hat{\mathbf{h}}_m\right)
    + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s3}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\hat{\mathbf{z}} \times \frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) \hat{\mathbf{z}} \times \hat{\mathbf{e}}_m
  \\
  &amp; \qquad + a_m \left(
        \hat{\mathbf{z}} \times \left( - \nabla_t {\hat{e}_m}_z\right)
        + \nabla_t \times {\hat{\mathbf{e}}_m}_t
        + i \, \omega \, \mu_0 \, \hat{\mathbf{h}}_m
    \right)
    + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s4}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\hat{\mathbf{z}} \times \frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) \hat{\mathbf{z}} \times \hat{\mathbf{e}}_m
  \\
  &amp; \qquad + a_m \left(\hat{\mathbf{z}} \times \left(i \, \beta_m \, {\hat{\mathbf{e}}_m}_t \right)\right)
    + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s5}
\end{align}\end{split}\]</div>
<p>where the last step was accomplished by substitution of eq-3c and eq-3e from the <a class="reference internal" href="nonlinear_optics.html#Local-Modes"><span class="std std-ref">Nonlinear Optics</span></a> section.</p>
<p>Expanding the backward propagating modes, and using the forward/backward mode relationships yields an equation in terms of the spatial distribution of only the forward propagating modes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= \sum_m \left(
    a_m \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) {\hat{\mathbf{e}}_m}_t
    + i \, \beta_m \, a_m \, {\hat{\mathbf{e}}_m}_t
    + \left(\text{b.p.m.}\right)\right) \tag{s6}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) {\hat{\mathbf{e}}_m}_t
    + i \, \beta_m \, a_m \, {\hat{\mathbf{e}}_m}_t
  \\
  &amp; \qquad + a_{-m} \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_{-m}}_t\right)
    + \left(\frac{\partial}{\partial z} a_{-m}\right) {\hat{\mathbf{e}}_{-m}}_t
    + i \, \beta_{-m} \, a_{-m} \, {\hat{\mathbf{e}}_{-m}}_t
    \Biggr) \end{split} \tag{s7}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) {\hat{\mathbf{e}}_m}_t
    + i \, \beta_m \, a_m \, {\hat{\mathbf{e}}_m}_t
\\
&amp; \qquad + a_{-m} \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_{-m}\right) {\hat{\mathbf{e}}_m}_t
    - i \, \beta_m \, a_{-m} \, {\hat{\mathbf{e}}_m}_t
    \Biggr) \end{split} \tag{s8}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    \left(a_m + a_{-m}\right) \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} \left(a_m + a_{-m}\right)\right) {\hat{\mathbf{e}}_m}_t
  \\
  &amp; \qquad + i \, \beta_m \, \left(a_m - a_{-m}\right) \, {\hat{\mathbf{e}}_m}_t \Biggr) \end{split} \tag{s9}
\end{align}\end{split}\]</div>
<p>Right multiplying by the cross of <span class="math notranslate nohighlight">\(\hat{\mathbf{h}}^*_n\)</span> allows application of the orthogonality relationships:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \begin{split} \mathbf{0} &amp;= \iint_{A_\infty} \sum_m \Biggl(
    \left(a_m + a_{-m}\right) \left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right) \times \hat{\mathbf{h}}^*_n
  \\
  &amp; \qquad + \left(\frac{\partial}{\partial z} \left(a_m + a_{-m}\right)\right) \hat{\mathbf{e}}_m \times \hat{\mathbf{h}}^*_n
  \\
  &amp; \qquad + i \, \beta_m \, \left(a_m - a_{-m}\right) \, {\hat{\mathbf{e}}_m}_t \times \hat{\mathbf{h}}^*_n
\Biggr) \cdot \hat{\mathbf{z}} \, dA \end{split} \tag{s10}
\\
&amp; \begin{split} \phantom{\mathbf{0}} &amp;= \frac{\partial}{\partial z} \left(a_n + a_{-n}\right) + i \, \beta_n \, \left(a_n - a_{-n}\right)
  \\
  &amp; \qquad + \sum_m \iint_{A_\infty} \left(a_m + a_{-m}\right) \left(\left(\frac{\partial}{\partial z} {\hat{\mathbf{e}}_m}_t\right) \times {\hat{\mathbf{h}}^*_n}_t\right)  \cdot \hat{\mathbf{z}} \ dA \end{split} \tag{s11}
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Modal-Expansion-of-4d">
<h3>Modal Expansion of 4d<a class="headerlink" href="#Modal-Expansion-of-4d" title="Permalink to this headline">¶</a></h3>
<p>Inserting the expansion of eq-1 into eq-4d of Maxwell’s equations from the <a class="reference internal" href="nonlinear_optics.html#Unidirectional-Propagation-Equations"><span class="std std-ref">Nonlinear Optics</span></a> section yields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{J}_{f} + i \, \omega \, \mathbf{P}_\text{NL} &amp;= \sum_m \left(
    \nabla \times \left(a_m \, \hat{\mathbf{h}}_m\right)
    - i \, \omega \, \epsilon_0 \, \left(\mathbf{\epsilon} \cdot \left(a_m \ \hat{\mathbf{e}}_m\right)\right)
    + \left(\text{b.p.m.}\right)\right) \tag{s1}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\nabla \times \hat{\mathbf{h}}_m\right)
    + \left(\nabla a_m\right) \times \hat{\mathbf{h}}_m
  \\
  &amp; \qquad - a_m  \left(i \, \omega \, \epsilon_0 \, \left(\mathbf{\epsilon} \cdot \hat{\mathbf{e}}_m\right)\right)
    + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s2}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(
        \hat{\mathbf{z}} \times \left(
            \frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t
            - \nabla_t {\hat{h}_m}_z
        \right)
        + \nabla_t \times {\hat{\mathbf{h}}_m}_t
    \right)
  \\
  &amp; \qquad + \left(\frac{\partial}{\partial z} a_m\right) \hat{\mathbf{z}} \times \hat{\mathbf{h}}_m
    - a_m  \left(i \, \omega \, \epsilon_0 \, \left(\mathbf{\epsilon} \cdot \hat{\mathbf{e}}_m\right)\right)
    + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s3}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\hat{\mathbf{z}} \times \frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) \hat{\mathbf{z}} \times \hat{\mathbf{h}}_m
  \\
  &amp; \qquad + a_m \left(
        \hat{\mathbf{z}} \times \left(-\nabla_t {\hat{h}_m}_z\right)
        + \nabla_t \times {\hat{\mathbf{h}}_m}_t
        - i \, \omega \, \epsilon_0 \, \left(\mathbf{\epsilon} \cdot \hat{\mathbf{e}}_m\right)
    \right)
  \\
  &amp; \qquad + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s4}
\\
&amp; \begin{split} &amp;= \sum_m \Biggl(
    a_m \left(\hat{\mathbf{z}} \times \frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) \hat{\mathbf{z}} \times \hat{\mathbf{h}}_m
  \\
  &amp; \qquad + a_m \left(
        \hat{\mathbf{z}} \times \left(i \, \beta_m \, {\hat{\mathbf{h}}_m}_t\right)
        + i \, \omega \, \epsilon_0 \, \left(\mathbf{\epsilon}^{\prime} - \mathbf{\epsilon} \right) \cdot \hat{\mathbf{e}}_m \right)
  \\
  &amp; \qquad + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s5}
\end{align}\end{split}\]</div>
<p>where the last step was accomplished by substitution of eq-3d and eq-3f from the <a class="reference internal" href="nonlinear_optics.html#Local-Modes"><span class="std std-ref">Nonlinear Optics</span></a> section.</p>
<p>Expanding the backward propagating modes, and using the forward/backward mode relationships yields an equation in terms of the spatial distribution of only the forward propagating modes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; -\hat{\mathbf{z}} \times \left(\mathbf{J}_{f} + i \, \omega \, \mathbf{P}_\text{NL}\right)
\\
&amp; \begin{split} \qquad &amp;= \sum_m \Biggl(
    a_m \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) {\hat{\mathbf{h}}_m}_t
  \\
  &amp; \qquad + a_m \left(
        i \, \beta_m \, {\hat{\mathbf{h}}_m}_t
        + i \, \omega \, \epsilon_0 \, \hat{\mathbf{z}} \times \left(
            \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_m}_t
        \right)
    \right)
  \\
  &amp; \qquad + \left(\text{b.p.m.}\right)\Biggr) \end{split} \tag{s6}
\\
&amp; \begin{split} \qquad &amp;= \sum_m \Biggl(
    a_m \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) {\hat{\mathbf{h}}_m}_t
  \\
  &amp; \qquad + a_m \left(
        i \, \beta_m \, {\hat{\mathbf{h}}_m}_t
        + i \, \omega \, \epsilon_0 \ \hat{\mathbf{z}} \times \left(
            \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_m}_t
        \right)
    \right)
  \\
  &amp; \qquad + a_{-m} \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_{-m}}_t\right)
    + \left(\frac{\partial}{\partial z} a_{-m}\right) {\hat{\mathbf{h}}_{-m}}_t
  \\
  &amp; \qquad + a_{-m} \left(
        i \, \beta_{-m} \, {\hat{\mathbf{h}}_{-m}}_t
        + i \, \omega \, \epsilon_0 \, \hat{\mathbf{z}} \times \left(
            \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_{-m}}_t
        \right)
    \right)
\Biggr) \end{split} \tag{s7}
\\
&amp; \begin{split} \qquad &amp;= \sum_m \Biggl(
    a_m \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
    + \left(\frac{\partial}{\partial z} a_m\right) {\hat{\mathbf{h}}_m}_t
  \\
  &amp; \qquad + a_m \left(
        i \, \beta_m \, {\hat{\mathbf{h}}_m}_t
        + i \, \omega \, \epsilon_0 \, \hat{\mathbf{z}} \times \left(
            \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_m}_t
        \right)
    \right)
  \\
  &amp; \qquad - a_{-m} \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
    - \left(\frac{\partial}{\partial z} a_{-m}\right) {\hat{\mathbf{h}}_m}_t
  \\
  &amp; \qquad + a_{-m} \left(
        i \, \beta_m \, {\hat{\mathbf{h}}_m}_t
        + i \, \omega \, \epsilon_0 \, \hat{\mathbf{z}} \times \left(
            \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_m}_t
        \right)
    \right)
\Biggr) \end{split} \tag{s8}
\\
&amp; \begin{split} \qquad &amp;= \sum_m \Biggl(
    \left(a_m - a_{-m}\right) \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
  \\
  &amp; \qquad + \left(\frac{\partial}{\partial z} \left(a_m - a_{-m}\right)\right) {\hat{\mathbf{h}}_m}_t
  \\
  &amp; \qquad + \left(a_m + a_{-m}\right) \left(
        i \, \beta_m \, {\hat{\mathbf{h}}_m}_t
        + i \, \omega \, \epsilon_0 \, \hat{\mathbf{z}} \times \left(
            \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_m}_t
        \right)
    \right)
\Biggr) \end{split} \tag{s9}
\\
\end{align}\end{split}\]</div>
<p>Left multiplying by the cross of <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}_n^*\)</span> allows application of the orthogonality relationships:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; -\iint_{A_\infty} \left(\hat{\mathbf{e}}_n^* \times \left(\hat{\mathbf{z}} \times \mathbf{J}_{f}\right) + i \, \omega \, \hat{\mathbf{e}}_n^* \times \left(\hat{\mathbf{z}} \times \mathbf{P}_\text{NL}\right)\right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \qquad \begin{split} &amp;=
    \iint_{A_\infty} \sum_m \Biggl(
    \left(a_m - a_{-m}\right) \, \hat{\mathbf{e}}_n^* \times \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)
  \\
  &amp; \qquad + \left(\frac{\partial}{\partial z} \left(a_m - a_{-m}\right)\right) \, \hat{\mathbf{e}}_n^* \times \hat{\mathbf{h}}_m
  \\
  &amp; \qquad + \left(a_m + a_{-m}\right) \Bigl(i \, \beta_m \, \hat{\mathbf{e}}_n^* \times {\hat{\mathbf{h}}_m}_t
  \\
  &amp; \qquad + i \, \omega \, \epsilon_0 \, \hat{\mathbf{e}}_n^* \times \left(\hat{\mathbf{z}} \times \left(
  \left(\epsilon_t - \epsilon_t^{\prime}\right) \cdot {\hat{\mathbf{e}}_m}_t
  \right)\right) \Bigr)
\Biggr) \cdot \hat{\mathbf{z}} \, dA \end{split} \tag{s10}
\\
&amp; -\iint_{A_\infty} \left({\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{J}_{f}}_t + i \, \omega \, {\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{P}_\text{NL}}_t\right) dA
\\
&amp; \qquad \begin{split} &amp;=
    \frac{\partial}{\partial z} \left(a_n - a_{-n}\right)
    + i \, \beta_n \, \left(a_n + a_{-n}\right)
  \\
  &amp; \qquad + \sum_m \iint_{A_\infty} \Biggl(
    \left(a_m - a_{-m}\right) \left({\hat{\mathbf{e}}_n^*}_t \times \left(\frac{\partial}{\partial z} {\hat{\mathbf{h}}_m}_t\right)\right) \cdot \hat{\mathbf{z}}
  \\
  &amp; \qquad + \left(a_m + a_{-m}\right) i \, \omega \, \epsilon_0 \, {\hat{\mathbf{e}}_n^*}_t \cdot \left(
        \left(\epsilon_t - \epsilon^{\prime}_t\right) \cdot {\hat{\mathbf{e}}_m}_t
    \right)
\Biggr) dA \end{split} \tag{s11}
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Forward-Mode-Propagation-Equation">
<h3>Forward Mode Propagation Equation<a class="headerlink" href="#Forward-Mode-Propagation-Equation" title="Permalink to this headline">¶</a></h3>
<p>The forward mode propagation equation is found by adding the two curl relations (eq-4c + eq-4d) from the <a class="reference internal" href="nonlinear_optics.html#Unidirectional-Propagation-Equations"><span class="std std-ref">Nonlinear Optics</span></a> section.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; -\iint_{A_\infty} \left({\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{J}_{f}}_t + i \, \omega \, {\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{P}_\text{NL}}_t\right) \, dA
\\
&amp; \qquad = 2 \left(
    \frac{\partial}{\partial z} a_n
    + i \, \beta_n \, a_n
\right)
\\
&amp; \qquad \quad + \sum_m \left(a_m + a_{-m}\right) \iint_{A_\infty} \left(
        \frac{\partial {\hat{\mathbf{e}}_m}_t}{\partial z} \times {\hat{\mathbf{h}}^*_n}_t
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \qquad \quad + \sum_m \left(a_m - a_{-m}\right) \iint_{A_\infty} \left(
        {\hat{\mathbf{e}}_n^*}_t \times \frac{\partial {\hat{\mathbf{h}}_m}_t}{\partial z}
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \qquad \quad + \sum_m \left(a_m + a_{-m}\right) \iint_{A_\infty} \left(
    i \, \omega \, \epsilon_0 \, {\hat{\mathbf{e}}_n^*}_t \cdot
        \left(\epsilon_t - \epsilon^{\prime}_t\right) \cdot {\hat{\mathbf{e}}_m}_t
\right) dA
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial}{\partial z} a_n =&amp; \text{ Linear Dispersion:}
\\
&amp; - i \, \beta_n \, a_n
\\
&amp; \text{ Gain or Loss:}
\\
&amp; - \sum_{m} \left(a_m + a_{-m}\right) \iint_{A_\infty} \frac{1}{2} \left(
    i \, \omega \, \epsilon_0 \, {\hat{\mathbf{e}}_n^*}_t \cdot
        \left(\epsilon_t - \epsilon^{\prime}_t\right) \cdot {\hat{\mathbf{e}}_m}_t
    \right) dA
\\
&amp; \text{ Changing Mode Profiles (f.p.m.):}
\\
&amp; - \sum_{m} a_m \iint_{A_\infty} \frac{1}{2} \left(
        \frac{\partial {\hat{\mathbf{e}}_m}_t}{\partial z} \times {\hat{\mathbf{h}}^*_n}_t + {\hat{\mathbf{e}}_n^*}_t \times \frac{\partial {\hat{\mathbf{h}}_m}_t}{\partial z}
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \text{ Changing Mode Profiles (b.p.m.):}
\\
&amp; - \sum_{m} a_{-m} \iint_{A_\infty} \frac{1}{2} \left(
        \frac{\partial {\hat{\mathbf{e}}_{-m}}_t}{\partial z} \times {\hat{\mathbf{h}}^*_n}_t + {\hat{\mathbf{e}}_n^*}_t \times \frac{\partial {\hat{\mathbf{h}}_{-m}}_t}{\partial z}
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \text{ Free Sources and Nonlinearity:}
\\
&amp; -\iint_{A_\infty} \frac{1}{2} \left({\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{J}_{f}}_t + i \, \omega \, {\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{P}_\text{NL}}_t\right) \, dA
\end{align}\end{split}\]</div>
</div>
<div class="section" id="Backward-Mode-Propagation-Equation">
<h3>Backward Mode Propagation Equation<a class="headerlink" href="#Backward-Mode-Propagation-Equation" title="Permalink to this headline">¶</a></h3>
<p>The backward mode propagation equation is found by subtracting the two curl relations (eq-4c - eq-4d) from the <a class="reference internal" href="nonlinear_optics.html#Unidirectional-Propagation-Equations"><span class="std std-ref">Nonlinear Optics</span></a> section.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; +\iint_{A_\infty} \left({\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{J}_{f}}_t + i \, \omega \, {\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{P}_\text{NL}}_t\right) dA
\\
&amp; \qquad = 2 \left(
    \frac{\partial}{\partial z} a_{-n}
    - i \, \beta_n \, a_{-n}
    \right)
\\
&amp; \qquad \quad + \sum_m \left(a_m + a_{-m}\right) \iint_{A_\infty} \left( \frac{\partial {\hat{\mathbf{e}}_m}_t}{\partial z} \times {\hat{\mathbf{h}}^*_n}_t
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \qquad \quad - \sum_m \left(a_m - a_{-m}\right) \iint_{A_\infty} \left(
    {\hat{\mathbf{e}}_n^*}_t \times \frac{\partial {\hat{\mathbf{h}}_m}_t}{\partial z}
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \qquad \quad - \sum_m \left(a_m + a_{-m}\right) \iint_{A_\infty} \left(
    i \, \omega \, \epsilon_0 \, {\hat{\mathbf{e}}_n^*}_t \cdot
        \left(\epsilon_t - \epsilon^{\prime}_t\right) \cdot {\hat{\mathbf{e}}_m}_t
\right) dA
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial}{\partial z} a_{-n} =&amp; \text{ Linear Dispersion:}
\\
&amp; +i \, \beta_n \, a_{-n}
\\
&amp; \text{ Gain or Loss:}
\\
&amp; + \sum_m \left(a_m + a_{-m}\right) \iint_{A_\infty} \frac{1}{2} \left(
    i \, \omega \, \epsilon_0 \, {\hat{\mathbf{e}}_n^*}_t \cdot
        \left(\epsilon_t - \epsilon^{\prime}_t\right) \cdot {\hat{\mathbf{e}}_m}_t
    \right) dA
\\
&amp; \text{ Changing Mode Profiles (f.p.m.):}
\\
&amp; + \sum_m a_m \iint_{A_\infty} \frac{1}{2} \left(
        \frac{\partial {\hat{\mathbf{e}}_m}_t}{\partial z} \times {\hat{\mathbf{h}}^*_{-n}}_t + {\hat{\mathbf{e}}_{-n}^*}_t \times \frac{\partial {\hat{\mathbf{h}}_m}_t}{\partial z}
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \text{ Changing Mode Profiles (b.p.m.):}
\\
&amp; + \sum_m a_{-m} \iint_{A_\infty} \frac{1}{2} \left(
        \frac{\partial {\hat{\mathbf{e}}_{-m}}_t}{\partial z} \times {\hat{\mathbf{h}}^*_{-n}}_t + {\hat{\mathbf{e}}_{-n}^*}_t \times \frac{\partial {\hat{\mathbf{h}}_{-m}}_t}{\partial z}
    \right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp; \text{ Free Sources and Nonlinearity:}
\\
&amp; + \iint_{A_\infty} \frac{1}{2} \left({\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{J}_{f}}_t + i \, \omega \, {\hat{\mathbf{e}}_n^*}_t \cdot {\mathbf{P}_\text{NL}}_t\right) dA
\end{align}\end{split}\]</div>
</div>
</div>
<div class="section" id="Unit-Analysis-of-the-Effective-Nonlinear-Parameters">
<h2>Unit Analysis of the Effective Nonlinear Parameters<a class="headerlink" href="#Unit-Analysis-of-the-Effective-Nonlinear-Parameters" title="Permalink to this headline">¶</a></h2>
<p>The effective nonlinear parameter combines multiple effects attributable to the waveguide mode. Through unit analysis the effective nonlinearity may be written in terms of the effective mode areas, refractive indices, and nonlinear susceptibilities. The steps taken to arrive at this result are only explicitly drawn out for the second order nonlinearity, but they are easily extendible to the third order through the same procedure.</p>
<p>For mode <span class="math notranslate nohighlight">\(n\)</span> the second order nonlinearity is written as the product of sums over modes <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
\frac{\partial}{\partial z} a_n
= \ldots -i \, \omega \sum_{r s} \iint_{-\infty}^{\infty}
    g_{n r s}^{\left(2\right)}\!\left[\nu_1, \nu_2\right] a_r\!\left[\nu_1\right] a_s\!\left[\nu_2\right]
    \delta\!\left[\nu - \left(\nu_1 + \nu_2\right)\right] d\nu_1 \, d\nu_2
\\
g_{n r s}^{\left(2\right)}\!\left[\nu_1, \nu_2\right] = \iint_{A_\infty} \frac{1}{2} \epsilon_0 \, \chi^{\left(2\right)}_{i j k}\!\left[\nu_1, \nu_2\right] {{\hat{\mathbf{e}}_n^*}_t}_i\!\left[\nu_1 + \nu_2\right] {\hat{\mathbf{e}}_r}_j\!\left[\nu_1\right] {\hat{\mathbf{e}}_s}_k\!\left[\nu_2\right] dA
\end{gather}\end{split}\]</div>
<p>where the effective nonlinearity parameter <span class="math notranslate nohighlight">\((g_{n r s}^{\left(2\right)})\)</span> integrates out all transverse spatial dependence.</p>
<p>From the orthogonality relationship, the spatial dependence of the normalized electric field vector scales with the following relationship:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\hat{e} \sim \frac{1}{\sqrt{\epsilon_0 \, c \, n_\text{eff} \, A_\text{eff}}}
\end{gather}\]</div>
<p>If the effects of spatial overlap between modes can be ignored or absorbed into an effective susceptibility (<span class="math notranslate nohighlight">\(\chi^{\left(2\right)}_\text{eff}\)</span>), the expression for <span class="math notranslate nohighlight">\(g_{n r s}^{\left(2\right)}\)</span> can be replaced by its unit decomposition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{split}
\frac{\partial}{\partial z} a \sim \ldots -i \, \omega &amp;\iint_{-\infty}^{\infty} \frac{1}{2} \epsilon_0 \, \frac{A_\text{eff}}{\left(\epsilon_0 \, c \, n_\text{eff} \, A_\text{eff}\right)^{3/2}} \, \chi^{\left(2\right)}_\text{eff} \, a \, a
\\
&amp; \quad \delta\!\left[\nu - \left(\nu_1 + \nu_2\right)\right] d\nu_1 \, d\nu_2
\end{split}
\\
\begin{split}
\frac{\frac{\partial}{\partial z} a}{\sqrt{\epsilon_0 \, c \, n_\text{eff} \, A_\text{eff}}} \sim \ldots - \frac{1}{2} \frac{i \, \omega}{c \, n_\text{eff}} &amp;\iint_{-\infty}^{\infty} \chi^{\left(2\right)}_\text{eff} \frac{a}{\sqrt{\epsilon_0 \, c \, n_\text{eff} \, A_\text{eff}}} \frac{a}{\sqrt{\epsilon_0 \, c \, n_\text{eff} \, A_\text{eff}}}
\\
&amp; \quad \delta\!\left[\nu - \left(\nu_1 + \nu_2\right)\right] d\nu_1 \, d\nu_2
\end{split}
\end{gather}\end{split}\]</div>
<p>Taken together, the terms about each root-power amplitude <span class="math notranslate nohighlight">\(\left(a\right)\)</span> and the amplitude itself form a single quantity with units of electric field (see chapter 2 of <a class="reference external" href="https://doi.org/10.1016/C2015-0-05510-1">Nonlinear Optics (Boyd 2020)</a> for propagation equations of the same form). Following this logic, the quantities about each amplitude term are then associated with the quantities of that amplitude’s mode. Replacing the mode identifiers and manipulating the equation back to its
origin form yields a natural decomposition of the effective nonlinearity:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
\begin{split}
\frac{\frac{\partial}{\partial z} a_n}{\sqrt{\epsilon_0 \, c \, {n_\text{eff}}_n \, {A_\text{eff}}}_n} \sim \ldots - \frac{1}{2} \frac{i \, \omega}{c \, {n_\text{eff}}_n} &amp;\iint_{-\infty}^{\infty}
    {\chi^{\left(2\right)}_\text{eff}}_{n r s}
    \frac{a_r}{\sqrt{\epsilon_0 \, c \, {n_\text{eff}}_r \, {A_\text{eff}}_r}}
    \frac{a_s}{\sqrt{\epsilon_0 \, c \, {n_\text{eff}}_s \, {A_\text{eff}}_s}}
\\
&amp; \quad \delta\!\left[\nu - \left(\nu_1 + \nu_2\right)\right] d\nu_1 \, d\nu_2
\end{split}
\\
\begin{split}
\frac{\partial}{\partial z} a_n \sim \ldots -i \, \omega &amp;\iint_{-\infty}^{\infty}
    \left(\frac{1}{2} \sqrt{\frac{{A_\text{eff}}_n}{{A_\text{eff}}_r \, {A_\text{eff}}_s}} \frac{{\chi^{\left(2\right)}_\text{eff}}_{n r s}}{\sqrt{\epsilon_0 \, c^3 \, {n_\text{eff}}_n \, {n_\text{eff}}_r \, {n_\text{eff}}_s}}\right) a \, a
\\
&amp; \quad \delta\!\left[\nu - \left(\nu_1 + \nu_2\right)\right] d\nu_1 \, d\nu_2
\end{split}
\\
g_{n r s}^{\left(2\right)} = \frac{1}{2} \sqrt{\frac{{A_\text{eff}}_n}{{A_\text{eff}}_r \, {A_\text{eff}}_s}} \frac{{\chi^{\left(2\right)}_\text{eff}}_{n r s}}{\sqrt{\epsilon_0 \, c^3 \, {n_\text{eff}}_n \, {n_\text{eff}}_r \, {n_\text{eff}}_s}}
\end{gather}\end{split}\]</div>
<p>where the frequency dependence of each mode is implicitly assumed.</p>
<p>And likewise, for the third order nonlinearity:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
g_{n q r s}^{\left(3\right)} = \frac{1}{2} \sqrt{\frac{{A_\text{eff}}_n}{{A_\text{eff}}_q \, {A_\text{eff}}_r \, {A_\text{eff}}_s}} \frac{{\chi^{\left(3\right)}_\text{eff}}_{n q r s}}{\epsilon_0 \, c^2 \, \sqrt{{n_\text{eff}}_n \, {n_\text{eff}}_q \, {n_\text{eff}}_r \, {n_\text{eff}}_s}}
\end{equation}\]</div>
</div>
<div class="section" id="Relationship-Between-Kerr-Parameter-and-Nonlinear-Susceptibility">
<h2>Relationship Between Kerr Parameter and Nonlinear Susceptibility<a class="headerlink" href="#Relationship-Between-Kerr-Parameter-and-Nonlinear-Susceptibility" title="Permalink to this headline">¶</a></h2>
<p>The nonlinear Kerr parameter (<span class="math notranslate nohighlight">\(n_2\)</span>) describes the change in refractive index due to the instantaneous, time averaged optical power. For single frequency, linearly polarized light:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
n &amp;= n_0 + n_2 \left&lt;I\right&gt;
\\
&amp;= n_0 + n_2 \left( \epsilon_0 \, c \, n_0 \left&lt;E^2\right&gt;\right)
\end{align}\end{split}\]</div>
<p>The third order nonlinear susceptibility <span class="math notranslate nohighlight">\(\left(\chi^{\left(3\right)}\right)\)</span> can be cast in terms of the Kerr parameter by relating the two through the definition of the relative permittivity <span class="math notranslate nohighlight">\(\left(\epsilon\right)\)</span>. Following a procedure similar to <a class="reference external" href="https://doi.org/10.1016/C2015-0-05510-1">Nonlinear Optics (Boyd 2020)</a>, a single frequency electric field is written as the sum of its Fourier amplitude <span class="math notranslate nohighlight">\(\left(A\right)\)</span>. Its instantaneous time average is then given by twice
the absolute square of that Fourier amplitude:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
E\!\left[t\right] = 2 A \cos\left[\omega \, t - \beta \, z\right] = A e^{-i \left(\omega \, t - \beta \, z\right)} + \text{c.c.}
\\
\left&lt;E^2\right&gt; = 2 \bigl|A\bigr|^2
\end{gather}\end{split}\]</div>
<p>The third order nonlinear polarization may also be expanded in terms of this single frequency field. Most importantly, the expansion includes a term proportional to the electric field:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
P_{NL} = \epsilon_0 \, \chi^{\left(3\right)} \, E\left[t\right]^3 = \epsilon_0 \, \chi^{\left(3\right)} \left(3 \, \bigl|A\bigr|^2 E\!\left[t\right] + \ldots\right)
\end{gather}\]</div>
<p>The relative permittivity is defined as the collection of terms in the electric displacement <span class="math notranslate nohighlight">\(\left(\mathbf{D}\right)\)</span> directly proportional to the electric field, and alternatively as the square of the refractive index:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\epsilon &amp;= 1 + \chi^{\left(1\right)} + 3 \, \chi^{\left(3\right)} \bigl|A\bigr|^2 + \ldots
\\ \\
\epsilon = n^2 &amp;= \left(n_0 + n_2 \left&lt;I\right&gt;\right)^2
\\
&amp;= n_0^2 + 2 \, n_0 \ n_2 \left&lt;I\right&gt; + \ldots
\\
&amp;= n_0^2 + 4 \, \epsilon_0 \, c \, n_0^2 \, n_2 \, \bigl|A\bigr|^2 + \ldots
\end{align}\end{split}\]</div>
<p>Finally, equating like terms, those with the same power of <span class="math notranslate nohighlight">\(A\)</span>, yields the following relationships for the electric susceptibilities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\chi^{\left(1\right)} &amp;= n_0^2 - 1
\\
\chi^{\left(3\right)} &amp;= \frac{4}{3} \epsilon_0 \, c \, n_0^2 \, n_2
\end{align}\end{split}\]</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="nonlinear_optics.html" title="previous page">Nonlinear Optics</a>
    <a class='right-next' id="next-link" href="../api.html" title="next page">PyNLO Reference</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, PyNLO authors.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.1.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>